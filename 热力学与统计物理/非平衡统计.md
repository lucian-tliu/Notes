# 非平衡统计

## 1 Boltzmann 方程

### 1.1 单粒子分布函数

在经典力学中，描述单个粒子的状态需要它在自己的 6 维相空间中的坐标 $(\boldsymbol{r},\boldsymbol{v})$，而单粒子分布函数实际上就是这个相空间上的数密度
$$
\newcommand \ra \rangle
\newcommand \la \langle
\newcommand \mr \mathrm
\newcommand \bm \boldsymbol
\newcommand \ds \displaystyle

\mr{d}N=f(\bm{r}, \bm{v}, t)\mr{d}^3\bm{r}\mr{d}^3\bm{v}
$$
表示在 $t$ 时刻，$(\bm{r},\bm{v})$ 附近 $\mr{d}^3\bm{r}\mr{d}^3\bm{v}$ 体元内粒子数的概率。在非平衡统计中，**单粒子分布函数** $f(\mathbf{r}, \mathbf{v}, t)$ 是最核心的概念，它是连接微观粒子运动与宏观流体性质（如密度、温度、压强）的桥梁。

通过 $f(\bm{r},\bm{v},t)$ 对不同的变量积分，可以得到不同的宏观变量：

- 粒子数密度：对速度变量积分
  $$
  n(\bm{r},t)=\int f(\bm{r},\bm{v},t)\mr{d}^3\bm{v}
  $$

- 宏观粒子速度：
  $$
  \bm{u}(\bm{r}, t) = \frac{1}{n(\bm{r}, t)} \int \bm{v} f(\bm{r}, \bm{v}, t)  \mr{d}^3\bm{v}
  $$

- 温度：
  $$
  \frac{3}{2}  k_B T =\frac{1}{n(\bm{r},t)} \int \frac{1}{2} m |\bm{v} - \bm{u}|^2 f(\bm{r}, \bm{v}, t)  \mr{d}^3\bm{v}
  $$
  

### 1.2 适用条件

Boltzmann 方程的推导在下面的条件下进行：具有短程力的经典稀薄气体

1. 经典：即满足非简并条件
   $$
   n\lambda_T\ll 1
   $$
   其中 $\ds\lambda_T=\frac{\hbar}{\sqrt{2\pi m k T}}$ 为粒子的热波长

2. 稀薄气体 + 短程力：这两个假设即分子之间的平均距离远大于分子间相互作用的力程，于是分子大部分之间都做自由运动，达到力程范围内才发生碰撞。因此考虑分布函数的变化时，可以把“自由运动”和“碰撞”的影响分开来考虑。
   这两个假设也使得多体碰撞的发生概率极低，因此可只考虑二体碰撞。

从上面的假设中，我们在考虑 $f(\bm{r},\bm{v},t)$ 的时间变化时，可以将其分离为**漂移(drift)项**和**碰撞(collision)项**
$$
\frac{\partial f}{\partial t}\mr{d}t\mr{d}^3\bm{r}\mr{d}^3\bm{v}=\left[\left(\frac{\partial f}{\partial t}\right)_{\text{d}}+\left(\frac{\partial f}{\partial t}\right)_{\text{c}}\right]\mr{d}t\mr{d}^3\bm{r}\mr{d}^3\bm{v}
$$

### 1.3 漂移项计算

自由运动会导致粒子离开 $\mr{d}^3\bm{r}$ 空间
$$
\mr{d}N_{\text{d}}=\left(\frac{\partial f}{\partial t}\right)_{\text{d}}\mr{d}t\mr{d}^3\bm{r}\mr{d}^3\bm{v}
$$
表示 $\mr{d}t$ 时间内，$(\bm{r},\bm{v})$ 附近体元 $\mr{d}^3\bm{r}\mr{d}^3\bm{v}$ 内分子数的增加。它等于 $\mr{d}t$ 内通过相空间内的 6 维正方体的 12 个面流入的粒子数。对单独一个面，变量为 $\xi$
$$
\begin{aligned}
\mr{d}N_\xi&=\frac{(f\dot{\xi})_{\xi}-(f\dot{\xi})_{\xi+\mr{d}\xi}}{\mr{d}\xi}\mr{d}t\mr{d}^3\bm{r}\mr{d}^3\bm{v}\\
&=-\frac{\partial(f\dot{\xi})}{\partial\xi}\mr{d}t\mr{d}^3\bm{r}\mr{d}^3\bm{v}

\end{aligned}
$$
于是
$$
\begin{aligned}
\left(\frac{\partial f}{\partial t}\right)_{\text{d}}\mr{d}t\mr{d}^3\bm{r}\mr{d}^3\bm{v}&=-\left(\frac{\partial(\dot{x}f)}{\partial x}+\cdots+\frac{\partial(\dot{v}_{x}f)}{\partial v_x}+\cdots\right)\mr{d}t\mr{d}^3\bm{r}\mr{d}^3\bm{v}\\
&=-\left(\frac{\partial(\bm{v}f)}{\partial\bm{r}}+\frac{\partial (\dot{\bm{v}}f)}{\partial\bm{v}}\right)\mr{d}t\mr{d}^3\bm{r}\mr{d}^3\bm{v}
\end{aligned}
$$
由于相空间中 $\bm{r},\bm{v}$ 是独立变量
$$
\frac{\partial (\bm{v}f)}{\partial \bm{r}}=\bm{v}\frac{\partial f}{\partial{\bm{r}}}
$$
由牛顿第二定理
$$
m\dot{v}=m\bm{\cal{F}}
$$
其中 $\cal{F}$ 是单位质量粒子上的力，对重力、电磁力都可以证明
$$
\frac{\partial \bm{\cal{F}}}{\partial\bm{v}}=0
$$
最终漂移项可以写作
$$
\left(\frac{\partial f}{\partial t}\right)_{\text{d}}\mr{d}t\mr{d}^3\bm{r}\mr{d}^3\bm{v}=-\left(\bm{v}\cdot\frac{\partial f}{\partial \bm{r}}+\bm{\cal{F}}\cdot\frac{\partial f}{\partial\bm{v}}\right)\mr{d}t\mr{d}^3\bm{r}\mr{d}^3\bm{v}
$$

### 1.4 碰撞项变化

由于碰撞是局域的，所以它只导致粒子离开 $\mr{d}^3\bm{v}$ 体元。因此只需要考虑粒子碰撞前后的速度变化。使用钢球模型，发生弹性碰撞，碰撞满足动量守恒和能量守恒
$$
m_1\bm{v}_1+m_2\bm{v}_2=m_1\bm{v}_1'+m_2\bm{v}_2'\\
\frac{1}{2}m_1{v_1}^2+\frac{1}{2}m_2{v_2}^2=\frac{1}{2}m_1{v_1'}^2+\frac{1}{2}m_2{v_2'}^2
$$
TODO

## 2 H 定理

热力学第二定理论断：孤立系的演化向着熵增加的方向进行。Boltzmann 提出 H 定理就是在尝试使用力学规律直接证明这个定理。后面会看到 H 定理确实能够解释宏观态演化的不可逆性，但它存在一些逻辑上的缺陷，仍只有一个统计理论，而非数学原理。

### 2.1 H 定理的证明

Boltzmann 定义了 H 函数
$$
H=\iint f(\bm{r},\bm{v},t)\ln f(\bm{r},\bm{v},t)\ \mr{d}^3\bm{r}\mr{d}^3\bm{v}
$$

$H$ 是分布函数的泛函。现在考虑一个孤立系中，$H$ 随时间的演化
$$
\begin{aligned}
\frac{\mr{d}H}{\mr{d}t}&=\frac{\mr{d}}{\mr{d}t}\iint f\ln f\ \mr{d}^3\bm{r}\mr{d}^3\bm{v}\\
&=\iint (1+\ln f)\frac{\partial f}{\partial t}\mr{d}^3\bm{r}\mr{d}^3\bm{v}
\end{aligned}
$$
将 $\partial f/\partial t$ 用 Boltzmann 方程替换
$$
\begin{aligned}
\frac{\mr{d}H}{\mr{d}t}=&-\iint(1+\ln f)\left(\bm{v}\cdot\frac{\partial f}{\partial\bm{r}}\right)\mr{d}^3\bm{r}\mr{d}^3\bm{v}\\
&-\iint(1+\ln f)\left(\bm{\cal{F}}\cdot\frac{\partial f}{\partial\bm{v}}\right)\mr{d}^3\bm{r}\mr{d}^3\bm{v}\\
&-\int(1+\ln f)(ff_1-f'f_1')\mr{d}^3\bm{v}\mr{d}^3\bm{v}_1\Lambda\mr{d}\Omega\mr{d}^3\bm{r}
\end{aligned}
$$
前两项来自于粒子漂移，第三项来自粒子碰撞。

1. 第一项：对 $\mr{d}^3\bm{r}$ 的积分
   $$
   \begin{aligned}
   \text{First Item}&=-\iint\frac{\partial}{\partial\bm{r}}\bm{v}\cdot(f\ln f)\mr{d}^3\bm{r}\\
   &=-\oiint \bm{n}\cdot(\bm{v}\cdot(f\ln f))\mr{d}\Sigma
   
   \end{aligned}
   $$
   上面使用 Green 公式化简，由于粒子不会跑出容器，因此第一项的积分为 0 

2. 第二项：对 $\mr{d}^3\bm{v}$ 的积分。前面已有 $\partial\bm{\cal{F}}/\partial\bm{v}=0$，因此
   $$
   \begin{aligned}
   \text{Second Item}&=-\iint\frac{\partial}{\partial\bm{v}}\bm{\cal{F}}\cdot(f\ln f)\mr{d}^3\bm{v}\\
   &=-\iiint\left(\frac{\partial}{\partial v_x}(\cal{F}_x f \ln f)\mr{+}\cdots\right)\mr{d}v_x\mr{d}v_y\mr{d}v_z
   \end{aligned}
   $$
   其中第一项对 $\mr{d}v_x$ 的积分
   $$
   -\int\frac{\partial}{\partial v_x}(\mathcal{F}_x f \ln f)\mr{d}v_x=-(\mathcal{F_x}f\ln f)|_{-\infty}^{+\infty}=0
   $$
   上面用到了 $v\to \infty$ 时，$f\to 0$（确保粒子数密度有限）

3. 因此只有碰撞项会导致 $H$ 的变化
   $$
   \frac{\mr{d}H}{\mr{d}t}=-\int(1+\ln f_1)(f_1f_2-f_1'f_2')\mr{d}^3\bm{v}_1\mr{d}^3\bm{v}_2\Lambda\mr{d}\Omega\mr{d}^3\bm{r}
   $$
   交换 $\bm{v}_1,\bm{v}_2$ 的符号，与上式相加再除以 2
   $$
   \frac{\mr{d}H}{\mr{d}t}=-\frac{1}{2}\int\int(2+\ln (f_1f_2))(f_1f_2-f_1'f_2')\mr{d}^3\bm{v}_1\mr{d}^3\bm{v}_2\Lambda\mr{d}\Omega\mr{d}^3\bm{r}
   $$
   对上式再交换 $\bm{v},\bm{v}'$ 的符号
   $$
   \frac{\mr{d}H}{\mr{d}t}=-\frac{1}{2}\int\int(2+\ln (f_1f_2))(f_1'f_2'-f_1f_2)\mr{d}^3\bm{v}_1'\mr{d}^3\bm{v}_2'\Lambda'\mr{d}\Omega'\mr{d}^3\bm{r}
   $$
   并利用
   $$
   \mr{d}^3\bm{v}_1=\mr{d}^3\bm{v}_1',\ \mr{d}^3\bm{v}_2=\mr{d}^3\bm{v}_2',\ \Lambda=\Lambda',\ \Omega=\Omega'
   $$
   再将 (22) 式与 (23) 式相加除以 2
   $$
   \frac{\mr{d}H}{\mr{d}t}=-\frac{1}{4}\int\left[\ln(f_1f_2)-\ln(f_1'f_2')\right](f_1f_2-f_1'f_2')\mr{d}^3\bm{v}_1\mr{d}^3\bm{v}_2\Lambda\mr{d}\Omega\mr{d}^3\bm{r}
   $$

对 (25) 式，做变量替换 $x=\ln(f_1f_2),\ y=ln(f_1'f_2')$，则被积函数
$$
g(x,y)=(x-y)(\mr{e}^x-\mr{e}^y)\geqslant 0
$$
等号仅在 $x=y$ 时成立。因此
$$
\frac{\mr{d}H}{\mr{d}t}\leqslant 0
$$
从上面的推导中，我们可以得到以下结论：

- 在一个孤立系中，系统向着 $H$ 函数单调减小的方向演化，直到平衡态
- 粒子的自由运动不会导致 $H$ 的变化，$H$ 的改变仅由碰撞引起
- 孤立系平衡的充要条件：$f_1f_2=f_1'f_2'$

> [!note]
>
> **对 H 定理的讨论：**
>
> Boltzmann 尝试直接通过基本力学定律导出热力学第二定律而建立的 H 定理，但需要承认 H 定理仍然是一个统计定理，而不是牛顿定律那样的基本定律。原因在于 Boltzmann 在推导碰撞项时使用了**分子混沌性假设**（即碰撞前分子的分布函数无关），但根据力学规律的时间反演，分子的分布函数必然是相关的。
>
> Loschmidt 就对 H 定律提出了这样的质疑，如果分子的微观运动遵循牛顿定律，那必然是可逆的。按一个方向演化 $H$ 单调减小，那么如果 $t$ 时刻所以粒子动量反向则 $H$ 就应该单调增加。宏观不可逆性实际是：一个孤立系中 $H$ 减少的概率远大于 $H$ 增大的概率。
>
> Poincare 在1890年证明了微观运动的可复性定理，称为**庞加莱回归**：在一个有限的、受约束的动力学系统中，只要经过足够长的时间，系统总会回到距离初始状态任意近的位置。Boltzmann 的解释是，对一个典型的宏观系统，庞加莱回归的时间非常长。

### 2.2 细致平衡

孤立系平衡态的充要条件
$$
f_1f_2=f_1'f_2'
$$
这个条件称为**细致平衡**。碰撞项的推导中，元碰撞数和元反碰撞数为
$$
\delta f_1^{(-)}=f_1f_2\mr{d}^3\bm{v}_1\mr{d}^3\bm{v}_2\Lambda\mr{d}\Omega\mr{d}^3\bm{r}\\
\delta f_1^{(+)}=f_1'f_2'\mr{d}^3\bm{v}_1\mr{d}^3\bm{v}_2\Lambda\mr{d}\Omega\mr{d}^3\bm{r}\\
$$
细致平衡的物理意义：**元碰撞数与元反碰撞数相同**。这导致分布函数不因碰撞改变。

更普遍的说：系统演化中某一元过程与元反过程效果抵消，就称为细致平衡。细致平衡原理：总体平衡的充要条件是细致平衡。

### 2.3 从细致平衡导出平衡态分布

对细致平衡方程两侧取对数
$$
\ln f(\bm{v}_1)+\ln f(\bm{v}_2)=\ln f(\bm{v}_1') +\ln f(\bm{v}_2')
$$
碰撞前后的守恒量有
$$
m\bm{v},\ \frac{1}{2}mv^2
$$
因此方程的通解可以写作
$$
\ln f=\alpha_0+\bm{\alpha}\cdot m\bm{v}+\alpha_4\frac{1}{2}mv^2
$$
改写为
$$
f=c_0\exp\left(-c_4\frac{1}{2}m(\bm{v}-\bm{c})^2\right)
$$
其中 5 个待定常数 $c_0,\ \bm{c}=\{c_1,c_2,c_3\},\ c_4$ 由以下条件确定
$$
n=\int f\ \mr{d}^3\bm{v}\\
\bm{v}_0=\frac{1}{n}\int \bm{v} f\ \mr{d}^3\bm{v}\\
\frac{3}{2}kT=\frac{1}{n}\int\frac{1}{2}m(\bm{v}-\bm{v}_0)^2f\ \mr{d}^3\bm{v}
$$
最终分布函数为
$$
f=n\left(\frac{m}{2\pi k T}\right)^{3/2}\exp\left\{-\frac{m}{2kT}(\bm{v}-\bm{v}_0)^2\right\}
$$
这就是 Maxwell 速率分布。将这个结果代入平衡态下的 Boltzmann 方程
$$
\bm{v}\frac{\partial f}{\partial \bm{r}}+\bm{\cal{F}}\cdot\frac{\partial f}{\partial \bm{v}}=0
$$
如果设 $\bm{\cal{F}}=-\nabla\varphi(\bm{r})$，则可得到粒子数密度分布
$$
n=n_0\exp\left[\frac{m}{2kT}\bm{v}_0^2-\frac{m}{kT}\varphi(\bm{r})\right]
$$

### 2.4 $H$ 函数与熵

将平衡态的分布函数代入 $H$ 函数的表达式，可积分得到
$$
H=N\left[\ln\frac{N}{V}+\frac{3}{2}\ln\left(\frac{m}{2\pi kT}\right)-\frac{3}{2}\right]
$$
而单原子理想气体的熵的公式为
$$
S=Nk\left[\ln\frac{V}{N}+\frac{3}{2}\ln T+\frac{3}{2}\ln\left(\frac{2\pi mk}{h^2}\right)\right]
$$
比较得到
$$
S=-k H+C
$$

## 3 熵流和熵产生率

公式 (40) 是在平衡态下导出的，我们将其推广到非平衡态，定义非平衡态的熵为
$$
\begin{aligned}
S&=-kH\\
&=-k\int f(\bm{r},\bm{v},t)\ln f(\bm{r},\bm{v},t)\mr{d}^3 \boldsymbol{r}\mr{d}^3\bm{v}
\end{aligned}
$$
于是，根据 H 定理，孤立系演化过程中
$$
\frac{\mr{d}S}{\mr{d}t}\geqslant 0 
$$
定义熵密度
$$
S=\int s(\bm{r},t)\mr{d}^3\bm{r}\\
s(\bm{r},t)=-k\int f\ln f\mr{d}^3\bm{v}
$$
考虑 $s(\bm{r},t)$ 的时间演化
$$
\frac{\partial s}{\partial t}=-k\int(1+\ln f)\frac{\partial f}{\partial t}\mr{d}^3\bm{v}
$$
使用 Boltzmann 方程替换 $\partial f/\partial t$，其中碰撞项记作 $(\partial f/\partial t)_c$
$$
\begin{aligned}
\frac{\mr{d}s}{\mr{d}t}=&\iint(1+\ln f)\left(\bm{v}\cdot\frac{\partial f}{\partial\bm{r}}\right)\mr{d}^3\bm{v}\\
&\iint(1+\ln f)\left(\bm{\cal{F}}\cdot\frac{\partial f}{\partial\bm{v}}\right)\mr{d}^3\bm{v}\\
&-\int(1+\ln f)\left(\frac{\partial f}{\partial t}\right)_c\mr{d}^3\bm{v}\mr{d}^3
\end{aligned}
$$
前面已经证明第二项等于0，第一项
$$
\iint(1+\ln f)\left(\bm{v}\cdot\frac{\partial f}{\partial\bm{r}}\right)\mr{d}^3\bm{v}=\frac{\partial}{\partial\bm{r}}\iint(\bm{vf\ln f})\mr{d}^3\bm{v}=-\nabla\cdot\bm{J}_s
$$
其中 
$$
\bm{J}_s=-k\int \bm{v}f\ln f\ \mr{d}^3\bm{v}
$$
称为熵流密度。定义熵产生率
$$
\theta=-k\int(1+\ln f)\left(\frac{\partial f}{\partial t}\right)_c\mr{d}^3\bm{v}
$$
表示由于分子间碰撞引起的单位时间、单位体积内的熵的改变。类似 H 定理的证明，可以证明
$$
\theta\geqslant0
$$
因此，方程 (44) 可以改写为
$$
\frac{\partial s}{\partial t}+\nabla\cdot \bm{J}_s=\theta
$$

## 4 简并气体的 Boltzmann 方程

考虑满足以下条件的简并气体：

1. 简并：
   $$
   n\lambda_T\sim 1
   $$
   其中 $\ds\lambda_T=\frac{\hbar}{\sqrt{2\pi m k T}}$ 为粒子的热波长

2. 体元 $\mr{d}^3\bm{r}\mr{d}^3\bm{p}$ 满足宏观小，微观大的条件，因此仍可使用相空间描述

3. 粒子间相互作用能可忽略

4. 仅考虑二体碰撞

### 4.1 Boltzmann 方程

分布函数为 $f(\bm{r},\bm{p},t)$ 考虑其时间变化率，仍可分为漂移项和碰撞项
$$
\frac{\partial f}{\partial t}=\left(\frac{\partial f}{\partial t}\right)_\text{d}+\left(\frac{\partial f}{\partial t}\right)_\text{c}
$$
其中漂移项结果与之前相同
$$
\left(\frac{\partial f}{\partial t}\right)_\text{d}=-\frac{\bm{p}}{m}\cdot\frac{\partial f}{\partial\bm{r}}-\bm{F}\cdot\frac{\partial f}{\partial \bm{p}}
$$
碰撞项的具体推导需要用到量子多体理论：

- 记 $W(\bm{p}_1,\bm{p}_2;\bm{p}_1',\bm{p}_2')$ 为从初态 $(\bm{p}_1,\bm{p}_2)$ 碰撞到 $(\bm{p}_1',\bm{p}_2')$ 的概率

- 分布函数因子需要做如下修改
  $$
  f_1f_2\to f_1f_2(1+\eta f_1')(1+\eta f_2')\\
  f_1'f_2'\to f_1'f_2'(1+\eta f_1)(1+\eta f_2)
  $$
  其中
  $$
  \eta=\begin{cases}
  +1&\text{for boson}\\
  -1&\text{for fermion}
  \end{cases}
  $$

Boltzmann 方程写作
$$
\frac{\partial f}{\partial t}+\frac{\bm{p}}{m}\cdot\frac{\partial f}{\partial \bm{r}}+\bm{F}\cdot\frac{\partial f}{\partial\bm{p}}=\iiint W(\bm{p},\bm{p}_1;\bm{p}',\bm{p}_1')[f'f_1'(1+\eta f)(1+\eta f_1)-ff_1(1+\eta f')(1+\eta f_1')]\mr{d}^3\bm{p}_1\mr{d}^3\bm{p}'\mr{d}^3\bm{p}_1'
$$

### 4.1 简并气体 H 定理

定义简并气体的 $H$ 函数为
$$
H=\iint\big\{f\ln f-\eta(1+\eta f)\ln(1+\eta f)\big\}\frac{\mr{d}^3\bm{r}\mr{d}^3\bm{p}}{h^3}
$$
按之前同样的方法可以证明
$$
\frac{\mr{d}H}{\mr{d}t}\leqslant0
$$
此时的细致平衡条件为
$$
\frac{f_1}{1+\eta f_1}+\frac{f_2}{1+\eta f_2}=\frac{f_1'}{1+\eta f_1'}+\frac{f_2'}{1+\eta f_2'}
$$

### 4.2 熵流和熵产生率

输运方程
$$
\frac{\partial s}{\partial t}+\nabla\cdot\bm{J}_s=\theta
$$
其中：

- 熵密度：
  $$
  s(\bm{r},t)=-k\int\big\{f\ln f-\eta(1+\eta f)\ln(1+\eta f)\big\}\frac{\mr{d}^3\bm{p}}{h^3}
  $$

- 熵流密度：
  $$
  \bm{J}_s=-k\int\frac{\bm{p}}{m}\big\{f\ln f-\eta(1+\eta f)\ln(1+\eta f)\big\}\frac{\mr{d}^3\bm{p}}{h^3}
  $$

- 熵产生率：
  $$
  \theta=-k\int\big\{(1+\ln f)-(1+\ln(1+\eta f))\big\}\left(\frac{\partial f}{\partial t}\right)_\text{c}\frac{\mr{d}^3\bm{p}}{h^3}
  $$
  可以证明 $\theta\geqslant0$

## 5 弛豫时间近似

